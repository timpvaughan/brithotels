{"version":3,"file":"wds-macro-replacement.js","sources":["includes/assets/js/es6/config-values.js","includes/assets/js/es6/post-objects-cache.js","includes/assets/js/es6/post-object-fetcher.js","includes/assets/js/es6/string-utils.js","includes/assets/js/es6/macro-replacement.js","includes/assets/js/es6/wds-macro-replacement.js"],"sourcesContent":["class Config_Values {\n\tstatic get(keys, scope = 'general') {\n\t\tif (!Array.isArray(keys)) {\n\t\t\tkeys = [keys];\n\t\t}\n\n\t\tlet value = window['_wds_' + scope] || {};\n\t\tkeys.forEach((key) => {\n\t\t\tif (value && value.hasOwnProperty(key)) {\n\t\t\t\tvalue = value[key];\n\t\t\t} else {\n\t\t\t\tvalue = '';\n\t\t\t}\n\t\t});\n\n\t\treturn value;\n\t}\n\n\tstatic get_bool(varname, scope = 'general') {\n\t\treturn !!this.get(varname, scope);\n\t}\n}\n\nexport default Config_Values;\n","import wp from 'wp';\nimport Config_Values from './config-values';\n\nclass PostObjectsCache {\n\tconstructor() {\n\t\tthis.authors = {};\n\t\tthis.taxonomy_terms = {};\n\n\t\tthis.register_api_fetch_middleware();\n\t}\n\n\tkey(prefix, id) {\n\t\tid = '' + id;\n\t\treturn prefix + id.trim();\n\t}\n\n\tadd_categories(cats) {\n\t\tthis.add_taxonomy_terms('category', cats);\n\t}\n\n\tget_categories(ids) {\n\t\treturn this.get_taxonomy_terms('category', ids);\n\t}\n\n\tadd_tags(tags) {\n\t\tthis.add_taxonomy_terms('post_tag', tags);\n\t\tthis.add_taxonomy_terms('post_tag', tags, 'name');\n\t}\n\n\tget_tags(ids) {\n\t\treturn this.get_taxonomy_terms('post_tag', ids);\n\t}\n\n\tauthor_key(id) {\n\t\treturn this.key('author-', id);\n\t}\n\n\tadd_authors(authors) {\n\t\tif (Array.isArray(authors)) {\n\t\t\tauthors.forEach((author) => {\n\t\t\t\tthis.add_author(author);\n\t\t\t});\n\t\t} else if (!!authors.id) {\n\t\t\tthis.add_author(authors);\n\t\t}\n\t}\n\n\tadd_author(author) {\n\t\tlet key = this.author_key(author.id);\n\t\tthis.authors[key] = author;\n\t}\n\n\tget_author(id) {\n\t\tlet key = this.author_key(id);\n\t\tif (this.authors.hasOwnProperty(key)) {\n\t\t\treturn this.authors[key];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tget_query_var(url, variable) {\n\t\tlet query = url.substring(1);\n\t\tlet vars = query.split(/[&?]/);\n\t\tfor (let i = 0; i < vars.length; i++) {\n\t\t\tlet pair = vars[i].split('=');\n\t\t\tif (decodeURIComponent(pair[0]) === variable) {\n\t\t\t\treturn decodeURIComponent(pair[1]);\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tregister_api_fetch_middleware() {\n\t\twp.apiFetch.use((options, next) => {\n\t\t\tif (this.is_term_request(options)) {\n\t\t\t\tlet fields = this.get_query_var(options.path, '_fields');\n\t\t\t\tif (fields) {\n\t\t\t\t\toptions.path = options.path.replace(\n\t\t\t\t\t\tencodeURIComponent(fields),\n\t\t\t\t\t\tencodeURIComponent(fields + ',description')\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet result = next(options);\n\t\t\tresult.then((values) => {\n\t\t\t\tif (this.is_category_request(options)) {\n\t\t\t\t\tthis.add_categories(values);\n\t\t\t\t}\n\n\t\t\t\tif (this.is_tag_request(options)) {\n\t\t\t\t\tthis.add_tags(values);\n\t\t\t\t}\n\n\t\t\t\tif (this.is_get_request(options, '/wp/v2/users/')) {\n\t\t\t\t\tthis.add_authors(values);\n\t\t\t\t}\n\n\t\t\t\tlet taxonomy = this.get_taxonomy_slug(options);\n\t\t\t\tif (taxonomy) {\n\t\t\t\t\tthis.add_taxonomy_terms(taxonomy, values);\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.log(error);\n\t\t\t});\n\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tget_taxonomy_slug(request) {\n\t\tif (\n\t\t\t(request.method && request.method !== 'GET')\n\t\t\t|| !request.path\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet taxonomies = this.get_taxonomies(),\n\t\t\tmatches = request.path.match(/\\/wp\\/v2\\/([a-z_-]*).*/);\n\n\t\tif (!matches || matches.length < 2 || !matches[1]) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn taxonomies.includes(matches[1])\n\t\t\t? matches[1]\n\t\t\t: false;\n\t}\n\n\tis_term_request(request) {\n\t\treturn this.is_category_request(request)\n\t\t\t|| this.is_tag_request(request)\n\t\t\t|| !!this.get_taxonomy_slug(request);\n\t}\n\n\tis_category_request(request) {\n\t\treturn this.is_get_request(request, '/wp/v2/categories');\n\t}\n\n\tis_tag_request(request) {\n\t\treturn this.is_get_request(request, '/wp/v2/tags');\n\t}\n\n\tis_get_request(request, keyword) {\n\t\treturn request\n\t\t\t&& (!request.method || request.method === 'GET')\n\t\t\t&& request.path\n\t\t\t&& request.path.includes(keyword);\n\t}\n\n\ttaxonomy_key(taxonomy, id) {\n\t\treturn this.key('taxonomy-' + taxonomy + '-term-', id);\n\t}\n\n\tget_taxonomy_terms(taxonomy, terms_ids) {\n\t\tlet terms = [];\n\t\tterms_ids.forEach((id) => {\n\t\t\tlet key = this.taxonomy_key(taxonomy, id);\n\t\t\tif (this.taxonomy_terms.hasOwnProperty(key)) {\n\t\t\t\tterms.push(this.taxonomy_terms[key]);\n\t\t\t}\n\t\t});\n\n\t\tif (terms.length !== terms_ids.length) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn terms;\n\t}\n\n\tadd_taxonomy_terms(taxonomy, terms, field = 'id') {\n\t\tif (Array.isArray(terms)) {\n\t\t\tterms.forEach((term) => {\n\t\t\t\tthis.add_taxonomy_term(taxonomy, term, field);\n\t\t\t});\n\t\t} else if (!!terms.id) {\n\t\t\tthis.add_taxonomy_term(taxonomy, terms, field);\n\t\t}\n\t}\n\n\tadd_taxonomy_term(taxonomy, term, field = 'id') {\n\t\tlet key = this.taxonomy_key(taxonomy, term[field]);\n\n\t\tthis.taxonomy_terms[key] = term;\n\t}\n\n\tget_taxonomies() {\n\t\treturn Config_Values.get('taxonomies', 'replacement');\n\t}\n}\n\nexport default PostObjectsCache;\n","import $ from 'jQuery';\nimport wp from 'wp';\n\nclass PostObjectFetcher {\n\t/**\n\t * @param postObjectsCache {PostObjectsCache}\n\t */\n\tconstructor(postObjectsCache) {\n\t\tthis.cache = postObjectsCache;\n\n\t\tthis.category_promise = null;\n\t\tthis.tag_promise = null;\n\t\tthis.author_promise = null;\n\t\tthis.term_promise = {};\n\t}\n\n\tfetch_category_data(ids) {\n\t\tif (!this.category_promise) {\n\t\t\tthis.category_promise = new Promise((resolve, reject) => {\n\t\t\t\tif (!ids || !ids.length) {\n\t\t\t\t\tresolve([]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet categories = this.cache.get_categories(ids);\n\t\t\t\tif (categories.length) {\n\t\t\t\t\tresolve(categories);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet params = $.param({include: ids}),\n\t\t\t\t\tpath = '/wp/v2/categories?' + params;\n\n\t\t\t\twp.apiFetch({path: path})\n\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t});\n\n\t\t\tthis.category_promise.then(() => {\n\t\t\t\tthis.category_promise = null;\n\t\t\t});\n\t\t}\n\n\t\treturn this.category_promise;\n\t}\n\n\tfetch_tag_data(ids) {\n\t\tif (!this.tag_promise) {\n\t\t\tthis.tag_promise = new Promise((resolve, reject) => {\n\t\t\t\tif (!ids || !ids.length) {\n\t\t\t\t\tresolve([]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet args = {};\n\t\t\t\tif (this.ids_numeric(ids)) {\n\t\t\t\t\targs.include = ids;\n\t\t\t\t} else if (this.ids_slugs(ids)) {\n\t\t\t\t\targs.slug = ids;\n\t\t\t\t} else {\n\t\t\t\t\treject('IDs malformed');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet tags = this.cache.get_tags(ids);\n\t\t\t\tif (tags.length) {\n\t\t\t\t\tresolve(tags);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet path = '/wp/v2/tags?' + $.param(args);\n\t\t\t\twp.apiFetch({path: path})\n\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t});\n\n\t\t\tthis.tag_promise.then(() => {\n\t\t\t\tthis.tag_promise = null;\n\t\t\t});\n\t\t}\n\n\t\treturn this.tag_promise;\n\t}\n\n\tfetch_taxonomy_terms(taxonomy, ids) {\n\t\tif (!this.term_promise.hasOwnProperty(taxonomy)) {\n\t\t\tthis.term_promise[taxonomy] = new Promise((resolve, reject) => {\n\t\t\t\tif (!ids || !ids.length) {\n\t\t\t\t\tresolve([]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet terms = this.cache.get_taxonomy_terms(taxonomy, ids);\n\t\t\t\tif (terms.length) {\n\t\t\t\t\tresolve(terms);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet params = $.param({include: ids}),\n\t\t\t\t\tpath = '/wp/v2/' + taxonomy + '?' + params;\n\n\t\t\t\twp.apiFetch({path: path})\n\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t});\n\n\t\t\tthis.term_promise[taxonomy].then(() => {\n\t\t\t\tdelete this.term_promise[taxonomy];\n\t\t\t});\n\t\t}\n\n\t\treturn this.term_promise[taxonomy];\n\t}\n\n\tfetch_author_data(id) {\n\t\tif (!this.author_promise) {\n\t\t\tthis.author_promise = new Promise((resolve, reject) => {\n\t\t\t\tif (!id) {\n\t\t\t\t\tresolve(false);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet author = this.cache.get_author(id);\n\t\t\t\tif (author) {\n\t\t\t\t\tresolve(author);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet path = '/wp/v2/users/' + id;\n\t\t\t\twp.apiFetch({path: path})\n\t\t\t\t\t.then((data) => {\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t});\n\n\t\t\tthis.author_promise.then(() => {\n\t\t\t\tthis.author_promise = null;\n\t\t\t});\n\t\t}\n\t\treturn this.author_promise;\n\t}\n\n\tids_numeric(ids) {\n\t\tif (!Array.isArray(ids)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn ids.reduce((all_numeric, id) => {\n\t\t\tlet is_numeric = !isNaN(id);\n\n\t\t\treturn all_numeric && is_numeric;\n\t\t}, true);\n\t}\n\n\tids_slugs(ids) {\n\t\tif (!Array.isArray(ids)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn ids.reduce((all_slugs, id) => {\n\t\t\tlet is_slug = isNaN(id);\n\n\t\t\treturn all_slugs && is_slug;\n\t\t}, true);\n\t}\n}\n\nexport default PostObjectFetcher;\n","import Config_Values from './config-values';\n\nclass String_Utils {\n\tstatic truncate_string(string, limit) {\n\t\tif (string.length > limit) {\n\t\t\tlet stringArray = Array.from(string);\n\t\t\tstring = stringArray.splice(0, limit - 4).join('').trim() + ' ...';\n\t\t}\n\n\t\treturn string;\n\t}\n\n\tstatic normalize_whitespace(string) {\n\t\t// Replace whitespace characters with simple spaces\n\t\tstring = string.replace(/(\\r\\n|\\n|\\r|\\t)/gm, \" \");\n\t\t// Replace each set of multiple consecutive spaces with a single space\n\t\tstring = string.replace(/[ ]+/g, \" \");\n\n\t\treturn string.trim();\n\t}\n\n\tstatic remove_shortcodes(string) {\n\t\tstring = string || '';\n\t\tif (string.indexOf('[') === -1) {\n\t\t\treturn string;\n\t\t}\n\n\t\t// Modified version of regex from PHP function get_shortcode_regex()\n\t\tlet regex = /\\[(\\[?)([a-zA-Z0-9_-]*)(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)\\[\\/\\2\\])?)(\\]?)/g,\n\t\t\tself = this;\n\n\t\treturn string.replace(regex, function (match, start_bracket, shortcode, attributes, match_4, content, end_bracket, offset, string) {\n\t\t\tif (arguments.length < 7) {\n\t\t\t\t// Not the expected regex for some reason. Try returning the full match or fall back to empty string.\n\t\t\t\treturn match || '';\n\t\t\t}\n\n\t\t\t// Allow [[foo]] syntax for escaping a tag.\n\t\t\tif ('[' === start_bracket && ']' === end_bracket) {\n\t\t\t\t// Return the whole matched string without the surrounding square brackets that were there for escaping\n\t\t\t\treturn match.substring(1, match.length - 1);\n\t\t\t}\n\n\t\t\tlet omitted = Config_Values.get('omitted_shortcodes', 'replacement');\n\t\t\tif (!!content && !omitted.includes(shortcode)) {\n\t\t\t\t// Call the removal method on the content nested in the current shortcode\n\t\t\t\t// This will continue recursively until we have removed all shortcodes\n\t\t\t\treturn self.remove_shortcodes(content.trim());\n\t\t\t}\n\n\t\t\t// Just remove the content-less, non-escaped shortcodes\n\t\t\treturn '';\n\t\t});\n\t}\n\n\tstatic strip_html(html) {\n\t\tlet div = document.createElement(\"DIV\");\n\t\tdiv.innerHTML = html;\n\t\treturn div.textContent || div.innerText || \"\";\n\t}\n\n\tstatic process_string(string, limit = false) {\n\t\tstring = String_Utils.strip_html(string);\n\t\tstring = String_Utils.normalize_whitespace(string);\n\t\tif (limit) {\n\t\t\tstring = String_Utils.truncate_string(string, limit);\n\t\t}\n\n\t\treturn string;\n\t}\n}\n\nexport default String_Utils;\n","import Post from './post';\nimport wp from 'wp';\nimport _ from '_';\nimport Config_Values from './config-values';\nimport String_Utils from './string-utils';\nimport Term from './term';\n\nclass MacroReplacement {\n\t/**\n\t * @param postObjectFetcher {PostObjectFetcher}\n\t */\n\tconstructor(postObjectFetcher) {\n\t\tthis.fetcher = postObjectFetcher;\n\t}\n\n\t/**\n\t * @param date {Date}\n\t * @param format {string}\n\t */\n\tformat_date(date, format) {\n\t\treturn wp.date.dateI18n(format, date);\n\t}\n\n\t/**\n\t * @param {Post} post\n\t */\n\tget_excerpt_or_trimmed_content(post) {\n\t\treturn this.get_trimmed_excerpt(\n\t\t\tpost.get_excerpt(),\n\t\t\tpost.get_content()\n\t\t);\n\t}\n\n\tget_trimmed_excerpt(excerpt, content) {\n\t\tlet string = !!excerpt ? excerpt : content,\n\t\t\tmetadesc_max_length = Config_Values.get('metadesc_max_length', 'replacement');\n\n\t\t// Strip all HTML tags\n\t\tstring = String_Utils.strip_html(string);\n\t\t// Normalize whitespace\n\t\tstring = String_Utils.normalize_whitespace(string);\n\n\t\tlet shortcode_position = string.indexOf('[');\n\t\tif (shortcode_position !== -1 && shortcode_position < metadesc_max_length) {\n\t\t\t// Remove shortcodes but keep the content\n\t\t\tstring = String_Utils.remove_shortcodes(string);\n\t\t}\n\t\t// TODO: Encode any HTML entities like > and <\n\n\t\treturn this.truncate_meta_description(string, metadesc_max_length);\n\t}\n\n\ttruncate_meta_description(string, metadesc_max_length) {\n\t\treturn String_Utils.truncate_string(string, metadesc_max_length);\n\t}\n\n\t/**\n\t * @param text\n\t * @param {Term} term\n\t * @returns {Promise<unknown>}\n\t */\n\treplace_term_macros(text, term) {\n\t\tlet specific_replacements = {\n\t\t\t'%%id%%': term.get_id(),\n\t\t\t'%%term_title%%': term.get_title(),\n\t\t\t'%%term_description%%': term.get_description(),\n\t\t};\n\n\t\tif (term.get_taxonomy() === 'category') {\n\t\t\tspecific_replacements['%%category%%'] = term.get_title();\n\t\t\tspecific_replacements['%%category_description%%'] = term.get_description();\n\t\t} else if (term.get_taxonomy() === 'post_tag') {\n\t\t\tspecific_replacements['%%tag%%'] = term.get_title();\n\t\t\tspecific_replacements['%%tag_description%%'] = term.get_description();\n\t\t}\n\n\t\treturn this.do_replace(text, {}, specific_replacements);\n\t}\n\n\t/**\n\t * @param text\n\t * @param {Post} post\n\t */\n\treplace(text, post) {\n\t\tlet fetcher = this.fetcher;\n\t\tlet load_required = {\n\t\t\t\"%%name%%\": () => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tfetcher.fetch_author_data(post.get_author_id())\n\t\t\t\t\t\t.then((author) => {\n\t\t\t\t\t\t\tlet name = author && author.name\n\t\t\t\t\t\t\t\t? author.name\n\t\t\t\t\t\t\t\t: '',\n\t\t\t\t\t\t\t\tmacro = {\"%%name%%\": name};\n\t\t\t\t\t\t\tresolve(macro);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(reject);\n\t\t\t\t});\n\t\t\t},\n\t\t\t\"%%category%%\": (matches, field = 'name', first_only = false) => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tfetcher.fetch_category_data(post.get_category_ids())\n\t\t\t\t\t\t.then((categories) => {\n\t\t\t\t\t\t\tlet category_names = this.get_term_macro_value(categories, field, first_only),\n\t\t\t\t\t\t\t\tmacro = {};\n\n\t\t\t\t\t\t\tif (matches && matches.length) {\n\t\t\t\t\t\t\t\tmacro[matches[0]] = category_names;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tresolve(macro);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(reject);\n\t\t\t\t});\n\t\t\t},\n\t\t\t\"%%tag%%\": (matches, field = 'name', first_only = false) => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tfetcher.fetch_tag_data(post.get_tag_ids())\n\t\t\t\t\t\t.then((tags) => {\n\t\t\t\t\t\t\tlet tags_names = this.get_term_macro_value(tags, field, first_only),\n\t\t\t\t\t\t\t\tmacro = {};\n\n\t\t\t\t\t\t\tif (matches && matches.length) {\n\t\t\t\t\t\t\t\tmacro[matches[0]] = tags_names;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tresolve(macro);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(reject);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tload_required['%%ct_(desc_){0,1}([a-z_]*)%%'] = (matches) => {\n\t\t\tlet field = 'name';\n\t\t\tif (matches.length === 3 && matches[1] === 'desc_') {\n\t\t\t\tfield = 'description';\n\t\t\t}\n\n\t\t\tlet taxonomy = matches[2];\n\t\t\tif (taxonomy === 'category') {\n\n\t\t\t\tlet category = load_required['%%category%%'];\n\t\t\t\treturn category(matches, field, true);\n\n\t\t\t} else if (taxonomy === 'post_tag') {\n\n\t\t\t\tlet tag = load_required['%%tag%%'];\n\t\t\t\treturn tag(matches, field, true);\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tfetcher\n\t\t\t\t\t.fetch_taxonomy_terms(taxonomy, post.get_taxonomy_terms(taxonomy))\n\t\t\t\t\t.then((terms) => {\n\t\t\t\t\t\tlet term_names = this.get_term_macro_value(terms, field, true),\n\t\t\t\t\t\t\tmacro = {};\n\n\t\t\t\t\t\tif (matches && matches.length) {\n\t\t\t\t\t\t\tmacro[matches[0]] = term_names;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve(macro);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(reject);\n\t\t\t});\n\t\t};\n\n\t\treturn this.do_replace(text, load_required, {\n\t\t\t\"%%id%%\": post.get_id(),\n\t\t\t\"%%title%%\": post.get_title(),\n\t\t\t\"%%excerpt%%\": this.get_excerpt_or_trimmed_content(post),\n\t\t\t\"%%excerpt_only%%\": post.get_excerpt(),\n\t\t\t\"%%modified%%\": this.format_date(post.get_modified(), 'Y-m-d H:i:s'),\n\t\t\t\"%%date%%\": this.format_date(post.get_date(), this.get_date_format()),\n\t\t\t\"%%userid%%\": post.get_author_id(),\n\t\t\t\"%%caption%%\": post.get_excerpt(),\n\t\t});\n\t}\n\n\tdo_replace(text, dynamic_macros, specific_replacements) {\n\t\tlet promises = [];\n\t\tObject.keys(dynamic_macros).forEach((macro) => {\n\t\t\tlet callback = dynamic_macros[macro],\n\t\t\t\tall_matches = [...text.matchAll(macro)];\n\n\t\t\tif (all_matches && all_matches.length) {\n\t\t\t\tall_matches.forEach((match) => {\n\t\t\t\t\tif (match && match.length) {\n\t\t\t\t\t\tpromises.push(callback(match));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tPromise\n\t\t\t\t.all(promises)\n\t\t\t\t.then((loaded) => {\n\t\t\t\t\tloaded.push(specific_replacements);\n\t\t\t\t\tloaded.push(this.get_general_replacements());\n\n\t\t\t\t\tlet replacements = loaded.reduce((result, current) => {\n\t\t\t\t\t\treturn Object.assign(result, current);\n\t\t\t\t\t}, {});\n\n\t\t\t\t\tObject.keys(replacements).forEach((macro_key) => {\n\t\t\t\t\t\tlet regex = new RegExp(macro_key, 'g');\n\t\t\t\t\t\ttext = text.replace(regex, replacements[macro_key]);\n\t\t\t\t\t});\n\n\t\t\t\t\t// Strip out any remaining unrecognized macros\n\t\t\t\t\tlet unrecognizedMacrosRegex = new RegExp('%%[a-zA-Z_]*%%', 'g');\n\t\t\t\t\ttext = text.replace(unrecognizedMacrosRegex, '');\n\n\t\t\t\t\tresolve(text);\n\t\t\t\t})\n\t\t\t\t.catch(reject);\n\t\t});\n\t}\n\n\tget_term_macro_value(terms, field, first_only) {\n\t\tif (!Array.isArray(terms)) {\n\t\t\tterms = [];\n\t\t}\n\n\t\tterms = _.sortBy(terms, (term) => {\n\t\t\treturn term.name;\n\t\t});\n\n\t\tlet values = terms.reduce(function (result, item) {\n\t\t\tif (item.hasOwnProperty(field)) {\n\t\t\t\tresult.push(item[field]);\n\t\t\t}\n\t\t\treturn result;\n\t\t}, []);\n\n\t\treturn first_only && values.length\n\t\t\t? values[0]\n\t\t\t: values.join(', ');\n\t}\n\n\tget_general_replacements() {\n\t\tlet timeFormat = Config_Values.get('time_format', 'replacement');\n\n\t\treturn {\n\t\t\t\"%%sep%%\": this.get_global('sep'),\n\t\t\t\"%%sitename%%\": this.get_global('sitename'),\n\t\t\t\"%%sitedesc%%\": this.get_global('sitedesc'),\n\t\t\t'%%page%%': this.get_global('page'),\n\t\t\t'%%pagetotal%%': this.get_global('pagetotal'),\n\t\t\t'%%pagenumber%%': this.get_global('pagenumber'),\n\t\t\t'%%spell_pagenumber%%': this.get_global('spell_pagenumber'),\n\t\t\t'%%spell_pagetotal%%': this.get_global('spell_pagetotal'),\n\t\t\t'%%spell_page%%': this.get_global('spell_page'),\n\t\t\t\"%%currenttime%%\": this.format_date(new Date(), timeFormat),\n\t\t\t\"%%currentdate%%\": this.format_date(new Date(), this.get_date_format()),\n\t\t\t\"%%currentmonth%%\": this.format_date(new Date(), 'F'),\n\t\t\t\"%%currentyear%%\": this.format_date(new Date(), 'Y'),\n\t\t};\n\t}\n\n\tget_date_format() {\n\t\treturn Config_Values.get('date_format', 'replacement');\n\t}\n\n\tget_global(key) {\n\t\treturn Config_Values.get(['replacements', key], 'replacement');\n\t}\n}\n\nexport default MacroReplacement;\n","import PostObjectsCache from \"./post-objects-cache\";\nimport PostObjectFetcher from \"./post-object-fetcher\";\nimport MacroReplacement from \"./macro-replacement\";\n\n(function () {\n\tlet postObjectsCache = new PostObjectsCache();\n\tlet postObjectFetcher = new PostObjectFetcher(postObjectsCache);\n\twindow.Wds.macroReplacement = new MacroReplacement(postObjectFetcher);\n})(jQuery);\n"],"names":["Config_Values","keys","scope","Array","isArray","value","window","forEach","key","hasOwnProperty","varname","get","PostObjectsCache","authors","taxonomy_terms","register_api_fetch_middleware","prefix","id","trim","cats","add_taxonomy_terms","ids","get_taxonomy_terms","tags","author","add_author","author_key","url","variable","query","substring","vars","split","i","length","pair","decodeURIComponent","wp","apiFetch","use","options","next","is_term_request","fields","get_query_var","path","replace","encodeURIComponent","result","then","values","is_category_request","add_categories","is_tag_request","add_tags","is_get_request","add_authors","taxonomy","get_taxonomy_slug","error","console","log","request","method","taxonomies","get_taxonomies","matches","match","includes","keyword","terms_ids","terms","taxonomy_key","push","field","term","add_taxonomy_term","PostObjectFetcher","postObjectsCache","cache","category_promise","tag_promise","author_promise","term_promise","Promise","resolve","reject","categories","get_categories","params","$","param","include","data","args","ids_numeric","ids_slugs","slug","get_tags","get_author","reduce","all_numeric","is_numeric","isNaN","all_slugs","is_slug","String_Utils","string","limit","stringArray","from","splice","join","indexOf","regex","self","start_bracket","shortcode","attributes","match_4","content","end_bracket","offset","arguments","omitted","remove_shortcodes","html","div","document","createElement","innerHTML","textContent","innerText","strip_html","normalize_whitespace","truncate_string","MacroReplacement","postObjectFetcher","fetcher","date","format","dateI18n","post","get_trimmed_excerpt","get_excerpt","get_content","excerpt","metadesc_max_length","shortcode_position","truncate_meta_description","text","specific_replacements","get_id","get_title","get_description","get_taxonomy","do_replace","load_required","fetch_author_data","get_author_id","name","macro","first_only","fetch_category_data","get_category_ids","category_names","get_term_macro_value","fetch_tag_data","get_tag_ids","tags_names","category","tag","fetch_taxonomy_terms","term_names","get_excerpt_or_trimmed_content","format_date","get_modified","get_date","get_date_format","dynamic_macros","promises","Object","callback","all_matches","matchAll","all","loaded","get_general_replacements","replacements","current","assign","macro_key","RegExp","unrecognizedMacrosRegex","_","sortBy","item","timeFormat","get_global","Date","Wds","macroReplacement","jQuery"],"mappings":"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"}